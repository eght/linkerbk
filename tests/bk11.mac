;; vim: set expandtab ai textwidth=80 softtabstop=8:
        .IF NDF BK11$MAC
        BK11$MAC=1
;;******************************************
;; Макросы системных вызовов монитора БК11М
;;******************************************

;; === Общесистемные
;; Инициализация монитора
        .MACRO  .BINIT
        jsr     PC,@140010
        .ENDM

;; Выход в монитор
        .MACRO  .BEXIT
        jsr     PC,@140012
        .ENDM

;; === Управление памятью
;; Прочитать подключение страниц
;; R0 - младший байт --- страница с 40000
;;      старший байт --- страница с 100000
        .MACRO  .BMEM
        jsr     PC,@140030
        .ENDM

;; Подключить страницу
;; ADDR <> 0 - подключить PAGE с 100000
;;      иначе подключить PAGE с 40000
        .MACRO  .BPAGE,PAGE,ADDR
        mov     #<ADDR*400>+PAGE,R0
        jsr     PC,@140034
        .ENDM

;; Назначить/получить рабочую страницу
;; если 15-ый бит = 0 --- установить страницу
;;                = 1 --- получить страницы (R0 ст.байт для вызовов, 
;;                                           мл.байт для чтения/записи
;; если 7-ой бит = 1 --- установить для вызова подпрограмм
;;                 0 --- установить для чтения/записи
        .MACRO  .BWORK,ARG
        mov     ARG,R0
        jsr     PC,@140036
        .ENDM

;; Вызвать подпрограмму из рабочей страницы
        .MACRO  .BJSR,ADDR
        mov     ADDR,-(SP)
        jsr     PC,@140054
        .ENDM

;; === Драйвер экрана
;; Установка режима
        .MACRO  .BTSET,MODE
        mov     MODE,R0
        jsr     PC,@140132
        .ENDM

;; Вывод строки
        .MACRO  .BSTR,ADDR
        mov     ADDR,R0
        jsr     PC,@140162
        .ENDM
;; === Доайвер клавиатуры
        .MACRO  .BTTIN
        jsr     PC,@140076
        .ENDM
        .ENDC
